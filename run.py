import subprocess
import time
import sys

# –ò–º—è —Ñ–∞–π–ª–∞ —Ç–≤–æ–µ–≥–æ –±–æ—Ç–∞
BOT_SCRIPT = "main.py"

def start_bot():
    print("üîã –ó–ê–ü–£–°–ö –ü–õ–ê–ù–ò–†–û–í–©–ò–ö–ê –°–ò–°–¢–ï–ú–´...")
    while True:
        try:
            # –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞ –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å
            print(f"\nüöÄ –ó–∞–ø—É—Å–∫ {BOT_SCRIPT}...")
            # sys.executable –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–≥–æ –∂–µ python (–∏–∑ venv)
            process = subprocess.Popen([sys.executable, BOT_SCRIPT])
            
            # –ñ–¥–µ–º, –ø–æ–∫–∞ –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç. –ö–æ–¥ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ç—É—Ç, –ø–æ–∫–∞ –±–æ—Ç –∂–∏–≤.
            process.wait()
            
            # –ï—Å–ª–∏ –º—ã —Ç—É—Ç - –∑–Ω–∞—á–∏—Ç –±–æ—Ç —É–ø–∞–ª –∏–ª–∏ –≤—ã–∫–ª—é—á–∏–ª—Å—è
            print(f"‚ö†Ô∏è –ë–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è —Å –∫–æ–¥–æ–º: {process.returncode}")
            
            # –ï—Å–ª–∏ –∫–æ–¥ –≤—ã—Ö–æ–¥–∞ 0 (—à—Ç–∞—Ç–Ω–æ–µ –≤—ã–∫–ª—é—á–µ–Ω–∏–µ), –º–æ–∂–Ω–æ –≤—ã–π—Ç–∏ —Å–æ–≤—Å–µ–º,
            # –Ω–æ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ –º—ã –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏–º –≤—Å—ë —Ä–∞–≤–Ω–æ (–∏–ª–∏ —Å–¥–µ–ª–∞–π break, –µ—Å–ª–∏ —Ö–æ—á–µ—à—å –ø–æ–ª–Ω–æ–≥–æ —Å—Ç–æ–ø–∞)
            if process.returncode == 0:
                 print("‚ôªÔ∏è –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã (–∫–æ–º–∞–Ω–¥–∞ /restart)...")
            else:
                 print("üî• –ö–†–ê–®! –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥...")
            
            time.sleep(3)
            
        except KeyboardInterrupt:
            print("\nüõë –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞.")
            break
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞: {e}")
            time.sleep(5)

if __name__ == "__main__":
    start_bot()